<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 네임스페이스(사용영역) 설정 -->
<mapper namespace="com.euishoe.products">

	<!-- 프로덕트 검색 기능 -->
	<select id="newProductList" resultType="map">
	<![CDATA[
		SELECT 	   p.product_num "productNum",  
			       p.product_list_num "productListNum", 
			       p.product_name "productName", 
			       p.product_cost "productCost", 
			       p.product_price "productPrice", 
			       p.product_brief_information "productBriefInfomation", 
			       p.product_manufacturer "productManufacturer", 
			       p.product_release_date "productReleaseDate", 
			       p.product_origin "productOrigin", 
			       p.product_list_price "productListPrice",
			       p.color_code "colorCode", 
			       p.product_hitcount "productHitcount", 
			       p.product_body "productBody", 
			       p.product_shoulder "productShoulder", 
			       p.product_arm "productArm", 
			       p.product_leg "productLeg", 
			       p.product_season "productSeason", 
			       p.product_fabric "productFabric", 
			       p.product_tpo "productTpo",
			       m.image_ref "imageRef"
		FROM   product_infos p 
		       join images m 
		         ON ( m.product_num = p.product_num ) 
		WHERE  p.product_num IN((SELECT product_num 
		                         FROM   (SELECT product_num, 
		                                        product_release_date 
		                                 FROM   product_infos 
		                                 WHERE  product_list_num IS NOT NULL 
		                                 ORDER  BY product_release_date DESC) 
		                         WHERE  ROWNUM <= 4))
	]]>
	</select>

	<select id="hitProductList" resultType="map">
	<![CDATA[
		SELECT 	   p.product_num "productNum",  
			       p.product_list_num "productListNum", 
			       p.product_name "productName", 
			       p.product_cost "productCost", 
			       p.product_price "productPrice", 
			       p.product_brief_information "productBriefInfomation", 
			       p.product_manufacturer "productManufacturer", 
			       p.product_release_date "productReleaseDate", 
			       p.product_origin "productOrigin", 
			       p.product_list_price "productListPrice",
			       p.color_code "colorCode", 
			       p.product_hitcount "productHitcount", 
			       p.product_body "productBody", 
			       p.product_shoulder "productShoulder", 
			       p.product_arm "productArm", 
			       p.product_leg "productLeg", 
			       p.product_season "productSeason", 
			       p.product_fabric "productFabric", 
			       p.product_tpo "productTpo",
			       m.image_ref "imageRef"
		FROM   product_infos p 
		       join images m 
		         ON ( m.product_num = p.product_num ) 
		WHERE  p.product_num IN (SELECT product_num 
		                         FROM   (SELECT product_num, 
		                                        product_hitcount 
		                                 FROM   product_infos 
		                                 WHERE  product_list_num IS NOT NULL 
		                                 ORDER  BY product_hitcount DESC) 
		                         WHERE  ROWNUM <= 4)	
	]]>
	</select>
	
	<select id="selectAll" resultType="map">
			SELECT p.product_num "productNum",  
			       p.product_list_num "productListNum", 
			       p.product_name "productName", 
			       p.product_cost "productCost", 
			       p.product_price "productPrice", 
			       p.product_brief_information "productBriefInfomation", 
			       p.product_manufacturer "productManufacturer", 
			       p.product_release_date "productReleaseDate", 
			       p.product_origin "productOrigin", 
			       p.product_list_price "productListPrice",
			       p.color_code "colorCode", 
			       p.product_hitcount "productHitcount", 
			       p.product_body "productBody", 
			       p.product_shoulder "productShoulder", 
			       p.product_arm "productArm", 
			       p.product_leg "productLeg", 
			       p.product_season "productSeason", 
			       p.product_fabric "productFabric", 
			       p.product_tpo "productTpo",
			       m.image_ref "imageRef"
			FROM product_infos p 
		       		join images m 
		         ON ( m.product_num = p.product_num )
	</select>
	
	<select id="selectImageRefByProductNum" parameterType="String" resultType="String">
			SELECT m.image_ref "imageRef"
			 FROM product_infos p 
			    join images m 
			      ON ( m.product_num = p.product_num )
			WHERE  p.product_num = #{productNum}
	</select>
	
	<select id="selectProductInfoByProductNum" parameterType="String" resultType="ProductInfo">
			SELECT product_num "productNum",  
			       product_list_num "productListNum", 
			       product_name "productName", 
			       product_cost "productCost", 
			       product_price "productPrice", 
			       product_brief_information "productBriefInfomation", 
			       product_manufacturer "productManufacturer", 
			       product_release_date "productReleaseDate", 
			       product_origin "productOrigin", 
			       product_list_price "productListPrice",
			       color_code "colorCode", 
			       product_hitcount "productHitcount", 
			       product_body "productBody", 
			       product_shoulder "productShoulder", 
			       product_arm "productArm", 
			       product_leg "productLeg", 
			       product_season "productSeason", 
			       product_fabric "productFabric", 
			       product_tpo "productTpo"
			FROM   product_infos
			WHERE  product_num = #{productNum}
	</select>
</mapper>